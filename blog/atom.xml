<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://batleforc.weebo.fr/WeeboGitOps/blog</id>
    <title>WeeboGitOps Blog</title>
    <updated>2023-08-19T00:00:00.000Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://batleforc.weebo.fr/WeeboGitOps/blog"/>
    <subtitle>WeeboGitOps Blog</subtitle>
    <icon>https://batleforc.weebo.fr/WeeboGitOps/img/favicon.ico</icon>
    <entry>
        <title type="html"><![CDATA[Renovate And Co]]></title>
        <id>https://batleforc.weebo.fr/WeeboGitOps/blog/Renovate-co</id>
        <link href="https://batleforc.weebo.fr/WeeboGitOps/blog/Renovate-co"/>
        <updated>2023-08-19T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[One mont later, what happened ?]]></summary>
        <content type="html"><![CDATA[<p>One mont later, what happened ?</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="whats-new">What's new<a href="#whats-new" class="hash-link" aria-label="Lien direct vers What's new" title="Lien direct vers What's new">​</a></h2><p>During the past month another project had my focus, the rewrite of my Rust Template with in the TDD/DDD way. I'm still working on it, but i was feeling the need to do something else.
So i decided to get back to my GitOps project and to do some cleanup and upgrade.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="automate-me">Automate me<a href="#automate-me" class="hash-link" aria-label="Lien direct vers Automate me" title="Lien direct vers Automate me">​</a></h2><p>Who's turn ? it's <a href="https://www.wireguard.com/" target="_blank" rel="noopener noreferrer">Wireguard's</a> turn to be automated with... terraform again. I'm starting to like this tool, it's really easy to use and to understand. And it's really powerfull. So what does the automation and upgrade does ?</p><ul><li>Create the Wireguard configuration (Peer, Interface, ...)</li><li>Create a secret with each peer (Server, Client1, ...)</li><li>Include AdGuard Home and the hability to access the Kubernetes internal DNS.</li><li>Build my own image of Wireguard to handle exposing metrics to Prometheus.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="upgrade">Upgrade<a href="#upgrade" class="hash-link" aria-label="Lien direct vers Upgrade" title="Lien direct vers Upgrade">​</a></h3><p>In order to facilitate my upgrade process, i setup <a href="https://www.mend.io/renovate/" target="_blank" rel="noopener noreferrer">Renovate</a> to handle the upgrade of my dependencies. It's really easy to use and it's working really well. I just need to execute the renovate job daily and it create PR when needed and merge it when i think it's ok.</p><p>Well we need everything to be up to date, so i upgraded everything to the latest version available like</p><ul><li>Terraform Zitadel from v1.0.0-alpha.18 to v1.0.0-alpha.19</li><li>Terraform Harbor from v3.9.4 to v3.10.1</li><li>Terraform Kubernetes from v2.22.0 to v2.23.0</li><li>Helm Release Loki from v4.6.1 to v5.14.1</li><li>Helm Release Tempo from v1.3.1 to v1.5.0</li><li>Helm Release Postgres from v12.6.5 to v12.8.3</li><li>Helm Release Redis from v17.13.2 to v17.15.5</li><li>Container Buildkit from v0.10.6 to v0.12.1 (and caching with harbor)</li></ul><p>While working on the upgrade part, i ended up thinking that setting up Changelog would be a good thing. So i'm thinking of including <a href="https://docs.cocogitto.io/" target="_blank" rel="noopener noreferrer">cog</a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="next-to-do">Next to do<a href="#next-to-do" class="hash-link" aria-label="Lien direct vers Next to do" title="Lien direct vers Next to do">​</a></h3><ul class="contains-task-list containsTaskList_mC6p"><li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Setup Changelog</li><li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Setup Cog</li><li class="task-list-item"><input type="checkbox" disabled=""> <!-- -->Automate Sonarqube <a href="https://github.com/batleforc/WeeboGitOps/issues/52" target="_blank" rel="noopener noreferrer">#52</a> that would end the automation of Zitadel <a href="https://github.com/batleforc/WeeboGitOps/issues/44" target="_blank" rel="noopener noreferrer">#44</a></li></ul><p>While i was upgrading everything it become obvious that i need to upgrade my use of Github. Then i moved from the old Github Dashboard to <a href="https://github.com/users/batleforc/projects/7/views/1" target="_blank" rel="noopener noreferrer">the new one</a>. Event if i wasn't writing the doc, i was still working on the project and updating the dashboard and issues.</p>]]></content>
        <author>
            <name>Maxime</name>
            <uri>https://github.com/batleforc</uri>
        </author>
        <category label="renovate" term="renovate"/>
        <category label="flux" term="flux"/>
        <category label="gitops" term="gitops"/>
        <category label="daily" term="daily"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[One year later]]></title>
        <id>https://batleforc.weebo.fr/WeeboGitOps/blog/one-year-later</id>
        <link href="https://batleforc.weebo.fr/WeeboGitOps/blog/one-year-later"/>
        <updated>2023-07-29T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Well it's been a little more than a year since the last post. I've been busy with a lot of things and I didn't have the time to write anything. But I'm back and I will try to write more often. If you are reading this, thank you for your interest in my blog about the GitOps project. I hope you will find it useful.]]></summary>
        <content type="html"><![CDATA[<p>Well it's been a little more than a year since the last post. I've been busy with a lot of things and I didn't have the time to write anything. But I'm back and I will try to write more often. If you are reading this, thank you for your interest in my blog about the GitOps project. I hope you will find it useful.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="whats-new">What's new<a href="#whats-new" class="hash-link" aria-label="Lien direct vers What's new" title="Lien direct vers What's new">​</a></h2><p>hmmm... Everything ? In the past few day, i just graduated from my Master degree, and just got my first job out of studie.
This project never stopped, but i didn't have enough time to write about it.</p><p>The goal is stil the same, having a fully automated kubernetes cluster, with a GitOps approach. Will following some Good practice.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="auth-me-now">Auth me now<a href="#auth-me-now" class="hash-link" aria-label="Lien direct vers Auth me now" title="Lien direct vers Auth me now">​</a></h3><p>One of the most nerf wrecking change was to kick out the old auth system <a href="https://www.keycloak.org/" target="_blank" rel="noopener noreferrer">Keycloak</a> and replace it with <a href="https://zitadel.com/" target="_blank" rel="noopener noreferrer">Zitadel</a>.</p><p>Why the change ? Zitadel bring the hability to <a href="https://github.com/users/batleforc/projects/7/views/1?pane=issue&amp;itemId=34063201" target="_blank" rel="noopener noreferrer">fully automate</a> (except SAML) the auth process and to create each application with a terraform "CronJob".</p><p>The pros of automating the auth process is that you dont need to create each thing by hand, and you can easily create a new application with a simple terraform file. And you are sure that whats automated will be the source of truth thought time.</p><p>At the moment i didn't find any cons, except for the huge amout of ram that <a href="https://www.cockroachlabs.com/" target="_blank" rel="noopener noreferrer">CochroachDB</a> need to run when considering Keycloak use Postgresql. (The saml part is not a cons, it's just not implemented yet).</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="automate-me">Automate me<a href="#automate-me" class="hash-link" aria-label="Lien direct vers Automate me" title="Lien direct vers Automate me">​</a></h3><p>With the new auth system, i was able to automate the oidc setup for each application. But by discovering Zitadel, i also discoverd <a href="https://www.terraform.io/" target="_blank" rel="noopener noreferrer">Terraform</a>.</p><p>It allow me to:</p><ul><li>Automate the oidc setup for each application (Grafana, Gitea, Harbor, WIP: Sonarqube, Oauth2Proxy, ...)</li><li>Automate Harbor (Project, Robot account, Configuration, ...)</li><li>Automate some simple step (creation of Kubeconfig)</li><li>Automate Sonarqube (WIP)</li><li>Automate Minio (WIP)</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="upgrade">Upgrade<a href="#upgrade" class="hash-link" aria-label="Lien direct vers Upgrade" title="Lien direct vers Upgrade">​</a></h3><p>Well we need everything to be up to date, so i upgraded everything to the latest version available like</p><ul><li>Gitea (need to be done manually, because each upgrade break everything) (1.18 -&gt; 1.20)</li><li>Tekton (Just an upgrade of the CRD)</li><li>Harbor (automated)</li><li>Haproxy (0.14.2 -&gt; 0.14.4)</li><li>CertManager</li><li>Tempo (replace Jaeger because it's easier to use)</li><li>Flux (0.41.2 -&gt; 2.0.1)</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="next-to-do">Next to do<a href="#next-to-do" class="hash-link" aria-label="Lien direct vers Next to do" title="Lien direct vers Next to do">​</a></h3><p>While i was upgrading everything it become obvious that i need to upgrade my use of Github. Then i moved from the old Github Dashboard to <a href="https://github.com/users/batleforc/projects/7/views/1" target="_blank" rel="noopener noreferrer">the new one</a>. Event if i wasn't writing the doc, i was still working on the project and updating the dashboard and issues.</p>]]></content>
        <author>
            <name>Maxime</name>
            <uri>https://github.com/batleforc</uri>
        </author>
        <category label="docusaurus" term="docusaurus"/>
        <category label="flux" term="flux"/>
        <category label="gitops" term="gitops"/>
        <category label="daily" term="daily"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Init Doc]]></title>
        <id>https://batleforc.weebo.fr/WeeboGitOps/blog/init-doc</id>
        <link href="https://batleforc.weebo.fr/WeeboGitOps/blog/init-doc"/>
        <updated>2022-07-10T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[Has of today this doc is being created in order to record why on how the GitOps paradigm is being used to manage the Weebo kubernetes cluster.]]></summary>
        <content type="html"><![CDATA[<p>Has of today this doc is being created in order to record why on how the GitOps paradigm is being used to manage the Weebo kubernetes cluster.</p>]]></content>
        <author>
            <name>Maxime</name>
            <uri>https://github.com/batleforc</uri>
        </author>
        <category label="init" term="init"/>
        <category label="docusaurus" term="docusaurus"/>
    </entry>
</feed>