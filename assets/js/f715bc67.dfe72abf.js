"use strict";(self.webpackChunkgit_ops_doc=self.webpackChunkgit_ops_doc||[]).push([[7023],{7893:e=>{e.exports=JSON.parse('{"blogPosts":[{"id":"layering","metadata":{"permalink":"/WeeboGitOps/blog/layering","editUrl":"https://github.com/batleforc/WeeboGitOps/tree/Doc/Main/blog/2023-09-12-Layer.md","source":"@site/blog/2023-09-12-Layer.md","title":"GitOps Layering","description":"What\'s new","date":"2023-09-12T00:00:00.000Z","formattedDate":"12 septembre 2023","tags":[{"label":"Layering","permalink":"/WeeboGitOps/blog/tags/layering"},{"label":"CNI","permalink":"/WeeboGitOps/blog/tags/cni"},{"label":"CSI","permalink":"/WeeboGitOps/blog/tags/csi"},{"label":"gitops","permalink":"/WeeboGitOps/blog/tags/gitops"},{"label":"daily","permalink":"/WeeboGitOps/blog/tags/daily"}],"readingTime":3.98,"hasTruncateMarker":false,"authors":[{"name":"Maxime","title":"Developer of this project","url":"https://github.com/batleforc","imageURL":"https://github.com/batleforc.png","key":"batleforc"}],"frontMatter":{"slug":"layering","title":"GitOps Layering","authors":"batleforc","tags":["Layering","CNI","CSI","gitops","daily"]},"nextItem":{"title":"Auto Auth","permalink":"/WeeboGitOps/blog/Auth"}},"content":"## What\'s new\\n\\nWell... i kinda change everything... again.\\n\\n## LAYERING OVER HEAVEN\\n\\nIn a attempt to fix some of the problem i had with my previous setup, i decided to change everything. I\'m still using the same tools, but i\'m using them differently.\\n\\nWhat was the kind of problem if encoutered:\\n\\n- During some deployment, some helm chart were locking all the deployment process due to a missing secret or other stuff. This was due to the fact that my depency were not well defined and that i was deploying a lot of stuff at the same time.\\n- One of the probleme was that Zitadel was needed by a lot of other stuff like Harbor, Sonarqube... well all the app that use the SSO. So if Zitadel was not ready, the deployment of all the other app was failing and then kind of interupted the deployment process.\\n- well... let\'s talk about tekton, the version used was not the latest and during the upgrade everything broke down due to incompatible change. So i decided to upgrade everything to the latest version. During the upgrade the webhook of tekton refused to stop and overloard the cluster. So i had to force delete the webhook and broke the cluster.\\n\\n### GitOps\\n\\nThe choice has been made to keep it but to change the deployment order/dependency and process. A layering process has been put in place. The idea is to have a layering of the deployment. Each layer is a set of application that are deployed together. The layer are deployed in order of requirement. The layer are:\\n\\n```mermaid\\nflowchart TB\\n    subgraph Layer1\\n        CRDS\\n        CSI\\n        CNI\\n        Namespace\\n        UserRightNamespace\\n        HelmSource\\n    end\\n    subgraph Layer2\\n        DNS\\n        CertManager\\n        HaProxyIngress\\n    end\\n    subgraph Layer3\\n        Secret\\n    end\\n    subgraph Layer4\\n        Harbor\\n        Zitadel\\n        Monitoring&Co\\n    end\\n    subgraph Layer5\\n        Gitea\\n        Gotify\\n        Microbin\\n        LonghornFront\\n        LonghornMonitoring\\n        Sonarqube\\n        Minio\\n    end\\n    subgraph Layer6\\n        AdguardHome\\n        Wireguard\\n    end\\n    subgraph Layer7\\n        Buildkit\\n        Renovate\\n        Tekton-app\\n        Tekton-operator\\n    end\\n    subgraph Layer8\\n        Dashy\\n        Kavita\\n        Quake\\n        Grocy\\n    end\\n    subgraph Layer9\\n        BuildAll\\n        Portfolio\\n        Template\\n        TektonInterceptor\\n    end\\n    Layer1 --\x3e Layer2\\n    Layer2 --\x3e Layer3\\n    Layer3 --\x3e Layer4\\n    Layer4 --\x3e Layer5\\n    Layer7 --\x3e Layer6\\n    Layer4 --\x3e Layer7\\n    Layer4 --\x3e Layer8\\n    Layer7 --\x3e Layer9\\n    BuildAll --\x3e Wireguard\\n```\\n\\n### CNI\\n\\nWhat is a CNI ? Well it\'s a Container Network Interface and it\'s used to create network for container. I\'m using [Cilium](https://cilium.io/) as my CNI. It\'s a really good CNI and it\'s working really well. I\'m using it in BGP mode, so i can have a really good network and i can use it to connect my cluster to my home network if needed. The setup is actually really easy but not complete at the moment. What i\'m missing:\\n\\n- [ ] Setup the Service Mesh\\n- [ ] Setup the Monitoring\\n- [ ] Setup the [Gateway Api](https://docs.cilium.io/en/stable/network/servicemesh/gateway-api/gateway-api/#what-is-gateway-api) - [Doc](https://gateway-api.sigs.k8s.io/)\\n\\n### CSI\\n\\nWhat is a CSI ? Well it\'s a Container Storage Interface and it\'s used to create storage for container. I\'m using [Longhorn](https://longhorn.io/) as my CSI. It\'s a really good CSI and it\'s working really well. I\'m also using it to backup my data.\\n\\n### Gateway Api\\n\\nDuring my search for more observability and security, i found the [Gateway Api](https://gateway-api.sigs.k8s.io/) relatable has a Ingress Killer. Why does the Ingress should be replaced by the GateWay Api? The Gateway Api is more compatible with the CNI and Service Mesh. It\'s also more secure and flexible by being more configurable. If you want to know more click on the link above.\\n\\n## Upgrade\\n\\nIn order to facilitate my upgrade process, i setup [Renovate](https://www.mend.io/renovate/) to handle the upgrade of my dependencies. It\'s really easy to use and it\'s working really well. I just need to execute the renovate job daily and it create PR when needed and merge it when i think it\'s ok.\\n\\nWell we need everything to be up to date, so i upgraded everything to the latest version available like\\n\\n- No Upgrade this time\\n\\nWhile working on the upgrade part, i ended up thinking that setting up Changelog would be a good thing. So i\'m thinking of including [cog](https://docs.cocogitto.io/).\\n\\n## Next to do\\n\\n- [ ] Setup the Service Mesh [#71](https://github.com/batleforc/WeeboGitOps/issues/71)\\n- [ ] Setup the Monitoring/Overservability of Cilium [#71](https://github.com/batleforc/WeeboGitOps/issues/71)\\n- [ ] Migrate to the Gateway Api [#70](https://github.com/batleforc/WeeboGitOps/issues/70)\\n- [ ] Slowly secure the Harbor Cache [#55](https://github.com/batleforc/WeeboGitOps/issues/55)\\n- [ ] Include KEDA and the PodAutoScaller [#17](https://github.com/batleforc/WeeboGitOps/issues/17)\\n- [ ] Pr\xe9parer l\'ajout de nouveaux uttilisateurs [#72](https://github.com/batleforc/WeeboGitOps/issues/72)\\n- [ ] Travailler sur un un \xe9quivalent a Tibco BW en passant possiblement par [Knative](https://knative.dev/) [#69](https://github.com/batleforc/WeeboGitOps/issues/69)\\n\\nWhile i was upgrading everything it become obvious that i need to upgrade my use of Github. Then i moved from the old Github Dashboard to [the new one](https://github.com/users/batleforc/projects/7/views/1). Event if i wasn\'t writing the doc, i was still working on the project and updating the dashboard and issues."},{"id":"Auth","metadata":{"permalink":"/WeeboGitOps/blog/Auth","editUrl":"https://github.com/batleforc/WeeboGitOps/tree/Doc/Main/blog/2023-08-20-Auth.md","source":"@site/blog/2023-08-20-Auth.md","title":"Auto Auth","description":"What\'s new","date":"2023-08-20T00:00:00.000Z","formattedDate":"20 ao\xfbt 2023","tags":[{"label":"Zitadel","permalink":"/WeeboGitOps/blog/tags/zitadel"},{"label":"terraform","permalink":"/WeeboGitOps/blog/tags/terraform"},{"label":"flux","permalink":"/WeeboGitOps/blog/tags/flux"},{"label":"gitops","permalink":"/WeeboGitOps/blog/tags/gitops"},{"label":"daily","permalink":"/WeeboGitOps/blog/tags/daily"}],"readingTime":1.39,"hasTruncateMarker":false,"authors":[{"name":"Maxime","title":"Developer of this project","url":"https://github.com/batleforc","imageURL":"https://github.com/batleforc.png","key":"batleforc"}],"frontMatter":{"slug":"Auth","title":"Auto Auth","authors":"batleforc","tags":["Zitadel","terraform","flux","gitops","daily"]},"prevItem":{"title":"GitOps Layering","permalink":"/WeeboGitOps/blog/layering"},"nextItem":{"title":"Renovate And Co","permalink":"/WeeboGitOps/blog/Renovate-co"}},"content":"## What\'s new\\n\\nDuring the night i finnaly found a way to automate Sonarqube with the help of... Oauth2Proxy and Terraform !!!!\\n\\n## Automate me\\n\\nSo it\'s the turn of Sonarqube to be automated with... terraform again. I love this tool ! So what does the automation and upgrade does ?\\n\\n- Separate Sonarqube from it\'s database with two helm release\\n- Setup Oauth2Proxy to handle the authentication of Sonarqube and ignore path that doesn\'t need authentication\\n- Setup the ingress to handle the authentication and the path to Sonarqube/Oauth2Proxy\\n- Automate the configuration of Sonarqube with TF\\n- Automate the creation of Sonarqube secret with TF\\n- RollBack to the previous version of Sonarqube from 10 to 9.9\\n\\n### Upgrade\\n\\nIn order to facilitate my upgrade process, i setup [Renovate](https://www.mend.io/renovate/) to handle the upgrade of my dependencies. It\'s really easy to use and it\'s working really well. I just need to execute the renovate job daily and it create PR when needed and merge it when i think it\'s ok.\\n\\nWell we need everything to be up to date, so i upgraded everything to the latest version available like\\n\\n- No Upgrade this time\\n\\nWhile working on the upgrade part, i ended up thinking that setting up Changelog would be a good thing. So i\'m thinking of including [cog](https://docs.cocogitto.io/).\\n\\n### Next to do\\n\\n- [ ] Setup Changelog\\n\\nWhile i was upgrading everything it become obvious that i need to upgrade my use of Github. Then i moved from the old Github Dashboard to [the new one](https://github.com/users/batleforc/projects/7/views/1). Event if i wasn\'t writing the doc, i was still working on the project and updating the dashboard and issues."},{"id":"Renovate-co","metadata":{"permalink":"/WeeboGitOps/blog/Renovate-co","editUrl":"https://github.com/batleforc/WeeboGitOps/tree/Doc/Main/blog/2023-08-19-Renovate.md","source":"@site/blog/2023-08-19-Renovate.md","title":"Renovate And Co","description":"One mont later, what happened ?","date":"2023-08-19T00:00:00.000Z","formattedDate":"19 ao\xfbt 2023","tags":[{"label":"renovate","permalink":"/WeeboGitOps/blog/tags/renovate"},{"label":"flux","permalink":"/WeeboGitOps/blog/tags/flux"},{"label":"gitops","permalink":"/WeeboGitOps/blog/tags/gitops"},{"label":"daily","permalink":"/WeeboGitOps/blog/tags/daily"}],"readingTime":1.92,"hasTruncateMarker":false,"authors":[{"name":"Maxime","title":"Developer of this project","url":"https://github.com/batleforc","imageURL":"https://github.com/batleforc.png","key":"batleforc"}],"frontMatter":{"slug":"Renovate-co","title":"Renovate And Co","authors":"batleforc","tags":["renovate","flux","gitops","daily"]},"prevItem":{"title":"Auto Auth","permalink":"/WeeboGitOps/blog/Auth"},"nextItem":{"title":"One year later","permalink":"/WeeboGitOps/blog/one-year-later"}},"content":"One mont later, what happened ?\\n\\n## What\'s new\\n\\nDuring the past month another project had my focus, the rewrite of my Rust Template with in the TDD/DDD way. I\'m still working on it, but i was feeling the need to do something else.\\nSo i decided to get back to my GitOps project and to do some cleanup and upgrade.\\n\\n## Automate me\\n\\nWho\'s turn ? it\'s [Wireguard\'s](https://www.wireguard.com/) turn to be automated with... terraform again. I\'m starting to like this tool, it\'s really easy to use and to understand. And it\'s really powerfull. So what does the automation and upgrade does ?\\n\\n- Create the Wireguard configuration (Peer, Interface, ...)\\n- Create a secret with each peer (Server, Client1, ...)\\n- Include AdGuard Home and the hability to access the Kubernetes internal DNS.\\n- Build my own image of Wireguard to handle exposing metrics to Prometheus.\\n\\n### Upgrade\\n\\nIn order to facilitate my upgrade process, i setup [Renovate](https://www.mend.io/renovate/) to handle the upgrade of my dependencies. It\'s really easy to use and it\'s working really well. I just need to execute the renovate job daily and it create PR when needed and merge it when i think it\'s ok.\\n\\nWell we need everything to be up to date, so i upgraded everything to the latest version available like\\n\\n- Terraform Zitadel from v1.0.0-alpha.18 to v1.0.0-alpha.19\\n- Terraform Harbor from v3.9.4 to v3.10.1\\n- Terraform Kubernetes from v2.22.0 to v2.23.0\\n- Helm Release Loki from v4.6.1 to v5.14.1\\n- Helm Release Tempo from v1.3.1 to v1.5.0\\n- Helm Release Postgres from v12.6.5 to v12.8.3\\n- Helm Release Redis from v17.13.2 to v17.15.5\\n- Container Buildkit from v0.10.6 to v0.12.1 (and caching with harbor)\\n\\nWhile working on the upgrade part, i ended up thinking that setting up Changelog would be a good thing. So i\'m thinking of including [cog](https://docs.cocogitto.io/).\\n\\n### Next to do\\n\\n- [ ] Setup Changelog\\n- [ ] Setup Cog\\n- [ ] Automate Sonarqube [#52](https://github.com/batleforc/WeeboGitOps/issues/52) that would end the automation of Zitadel [#44](https://github.com/batleforc/WeeboGitOps/issues/44)\\n\\nWhile i was upgrading everything it become obvious that i need to upgrade my use of Github. Then i moved from the old Github Dashboard to [the new one](https://github.com/users/batleforc/projects/7/views/1). Event if i wasn\'t writing the doc, i was still working on the project and updating the dashboard and issues."},{"id":"one-year-later","metadata":{"permalink":"/WeeboGitOps/blog/one-year-later","editUrl":"https://github.com/batleforc/WeeboGitOps/tree/Doc/Main/blog/2023-07-29-v3.md","source":"@site/blog/2023-07-29-v3.md","title":"One year later","description":"Well it\'s been a little more than a year since the last post. I\'ve been busy with a lot of things and I didn\'t have the time to write anything. But I\'m back and I will try to write more often. If you are reading this, thank you for your interest in my blog about the GitOps project. I hope you will find it useful.","date":"2023-07-29T00:00:00.000Z","formattedDate":"29 juillet 2023","tags":[{"label":"docusaurus","permalink":"/WeeboGitOps/blog/tags/docusaurus"},{"label":"flux","permalink":"/WeeboGitOps/blog/tags/flux"},{"label":"gitops","permalink":"/WeeboGitOps/blog/tags/gitops"},{"label":"daily","permalink":"/WeeboGitOps/blog/tags/daily"}],"readingTime":2.255,"hasTruncateMarker":false,"authors":[{"name":"Maxime","title":"Developer of this project","url":"https://github.com/batleforc","imageURL":"https://github.com/batleforc.png","key":"batleforc"}],"frontMatter":{"slug":"one-year-later","title":"One year later","authors":"batleforc","tags":["docusaurus","flux","gitops","daily"]},"prevItem":{"title":"Renovate And Co","permalink":"/WeeboGitOps/blog/Renovate-co"},"nextItem":{"title":"Init Doc","permalink":"/WeeboGitOps/blog/init-doc"}},"content":"Well it\'s been a little more than a year since the last post. I\'ve been busy with a lot of things and I didn\'t have the time to write anything. But I\'m back and I will try to write more often. If you are reading this, thank you for your interest in my blog about the GitOps project. I hope you will find it useful.\\n\\n## What\'s new\\n\\nhmmm... Everything ? In the past few day, i just graduated from my Master degree, and just got my first job out of studie.\\nThis project never stopped, but i didn\'t have enough time to write about it.\\n\\nThe goal is stil the same, having a fully automated kubernetes cluster, with a GitOps approach. Will following some Good practice.\\n\\n### Auth me now\\n\\nOne of the most nerf wrecking change was to kick out the old auth system [Keycloak](https://www.keycloak.org/) and replace it with [Zitadel](https://zitadel.com/).\\n\\nWhy the change ? Zitadel bring the hability to [fully automate](https://github.com/users/batleforc/projects/7/views/1?pane=issue&itemId=34063201) (except SAML) the auth process and to create each application with a terraform \\"CronJob\\".\\n\\nThe pros of automating the auth process is that you dont need to create each thing by hand, and you can easily create a new application with a simple terraform file. And you are sure that whats automated will be the source of truth thought time.\\n\\nAt the moment i didn\'t find any cons, except for the huge amout of ram that [CochroachDB](https://www.cockroachlabs.com/) need to run when considering Keycloak use Postgresql. (The saml part is not a cons, it\'s just not implemented yet).\\n\\n### Automate me\\n\\nWith the new auth system, i was able to automate the oidc setup for each application. But by discovering Zitadel, i also discoverd [Terraform](https://www.terraform.io/).\\n\\nIt allow me to:\\n\\n- Automate the oidc setup for each application (Grafana, Gitea, Harbor, WIP: Sonarqube, Oauth2Proxy, ...)\\n- Automate Harbor (Project, Robot account, Configuration, ...)\\n- Automate some simple step (creation of Kubeconfig)\\n- Automate Sonarqube (WIP)\\n- Automate Minio (WIP)\\n\\n### Upgrade\\n\\nWell we need everything to be up to date, so i upgraded everything to the latest version available like\\n\\n- Gitea (need to be done manually, because each upgrade break everything) (1.18 -> 1.20)\\n- Tekton (Just an upgrade of the CRD)\\n- Harbor (automated)\\n- Haproxy (0.14.2 -> 0.14.4)\\n- CertManager\\n- Tempo (replace Jaeger because it\'s easier to use)\\n- Flux (0.41.2 -> 2.0.1)\\n\\n### Next to do\\n\\nWhile i was upgrading everything it become obvious that i need to upgrade my use of Github. Then i moved from the old Github Dashboard to [the new one](https://github.com/users/batleforc/projects/7/views/1). Event if i wasn\'t writing the doc, i was still working on the project and updating the dashboard and issues."},{"id":"init-doc","metadata":{"permalink":"/WeeboGitOps/blog/init-doc","editUrl":"https://github.com/batleforc/WeeboGitOps/tree/Doc/Main/blog/2022-07-10-Init.md","source":"@site/blog/2022-07-10-Init.md","title":"Init Doc","description":"Has of today this doc is being created in order to record why on how the GitOps paradigm is being used to manage the Weebo kubernetes cluster.","date":"2022-07-10T00:00:00.000Z","formattedDate":"10 juillet 2022","tags":[{"label":"init","permalink":"/WeeboGitOps/blog/tags/init"},{"label":"docusaurus","permalink":"/WeeboGitOps/blog/tags/docusaurus"}],"readingTime":0.135,"hasTruncateMarker":false,"authors":[{"name":"Maxime","title":"Developer of this project","url":"https://github.com/batleforc","imageURL":"https://github.com/batleforc.png","key":"batleforc"}],"frontMatter":{"slug":"init-doc","title":"Init Doc","authors":"batleforc","tags":["init","docusaurus"]},"prevItem":{"title":"One year later","permalink":"/WeeboGitOps/blog/one-year-later"}},"content":"Has of today this doc is being created in order to record why on how the GitOps paradigm is being used to manage the Weebo kubernetes cluster."}]}')}}]);