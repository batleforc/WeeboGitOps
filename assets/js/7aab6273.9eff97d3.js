"use strict";(self.webpackChunkgit_ops_doc=self.webpackChunkgit_ops_doc||[]).push([[2504],{3905:(e,t,a)=>{a.d(t,{Zo:()=>c,kt:()=>m});var n=a(7294);function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,n,i=function(e,t){if(null==e)return{};var a,n,i={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(i[a]=e[a]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}var s=n.createContext({}),p=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},c=function(e){var t=p(e.components);return n.createElement(s.Provider,{value:t},e.children)},u="mdxType",h={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var a=e.components,i=e.mdxType,r=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),u=p(a),d=i,m=u["".concat(s,".").concat(d)]||u[d]||h[d]||r;return a?n.createElement(m,o(o({ref:t},c),{},{components:a})):n.createElement(m,o({ref:t},c))}));function m(e,t){var a=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=a.length,o=new Array(r);o[0]=d;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[u]="string"==typeof e?e:i,o[1]=l;for(var p=2;p<r;p++)o[p]=a[p];return n.createElement.apply(null,o)}return n.createElement.apply(null,a)}d.displayName="MDXCreateElement"},6497:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>o,default:()=>h,frontMatter:()=>r,metadata:()=>l,toc:()=>p});var n=a(7462),i=(a(7294),a(3905));const r={slug:"layering",title:"GitOps Layering",authors:"batleforc",tags:["Layering","CNI","CSI","gitops","daily"]},o=void 0,l={permalink:"/WeeboGitOps/blog/layering",editUrl:"https://github.com/batleforc/WeeboGitOps/tree/Doc/Main/blog/2023-09-12-Layer.md",source:"@site/blog/2023-09-12-Layer.md",title:"GitOps Layering",description:"What's new",date:"2023-09-12T00:00:00.000Z",formattedDate:"12 septembre 2023",tags:[{label:"Layering",permalink:"/WeeboGitOps/blog/tags/layering"},{label:"CNI",permalink:"/WeeboGitOps/blog/tags/cni"},{label:"CSI",permalink:"/WeeboGitOps/blog/tags/csi"},{label:"gitops",permalink:"/WeeboGitOps/blog/tags/gitops"},{label:"daily",permalink:"/WeeboGitOps/blog/tags/daily"}],readingTime:3.155,hasTruncateMarker:!1,authors:[{name:"Maxime",title:"Developer of this project",url:"https://github.com/batleforc",imageURL:"https://github.com/batleforc.png",key:"batleforc"}],frontMatter:{slug:"layering",title:"GitOps Layering",authors:"batleforc",tags:["Layering","CNI","CSI","gitops","daily"]},nextItem:{title:"Auto Auth",permalink:"/WeeboGitOps/blog/Auth"}},s={authorsImageUrls:[void 0]},p=[{value:"What&#39;s new",id:"whats-new",level:2},{value:"LAYERING OVER HEAVEN",id:"layering-over-heaven",level:2},{value:"GitOps",id:"gitops",level:3},{value:"CNI",id:"cni",level:3},{value:"CSI",id:"csi",level:3},{value:"Gateway Api",id:"gateway-api",level:3},{value:"Upgrade",id:"upgrade",level:2},{value:"Next to do",id:"next-to-do",level:2}],c={toc:p},u="wrapper";function h(e){let{components:t,...a}=e;return(0,i.kt)(u,(0,n.Z)({},c,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h2",{id:"whats-new"},"What's new"),(0,i.kt)("p",null,"Well... i kinda change everything... again."),(0,i.kt)("h2",{id:"layering-over-heaven"},"LAYERING OVER HEAVEN"),(0,i.kt)("p",null,"In a attempt to fix some of the problem i had with my previous setup, i decided to change everything. I'm still using the same tools, but i'm using them differently."),(0,i.kt)("h3",{id:"gitops"},"GitOps"),(0,i.kt)("p",null,"The choice has been made to keep it but to change the deployment order/dependency and process. A layering process has been put in place. The idea is to have a layering of the deployment. Each layer is a set of application that are deployed together. The layer are deployed in order of requirement. The layer are:"),(0,i.kt)("mermaid",{value:"flowchart TB\n    subgraph Layer1\n        CRDS\n        CSI\n        CNI\n        Namespace\n        UserRightNamespace\n        HelmSource\n    end\n    subgraph Layer2\n        DNS\n        CertManager\n        HaProxyIngress\n    end\n    subgraph Layer3\n        Secret\n    end\n    subgraph Layer4\n        Harbor\n        Zitadel\n        Monitoring&Co\n    end\n    subgraph Layer5\n        Gitea\n        Gotify\n        Microbin\n        LonghornFront\n        LonghornMonitoring\n        Sonarqube\n        Minio\n    end\n    subgraph Layer6\n        AdguardHome\n        Wireguard\n    end\n    subgraph Layer7\n        Buildkit\n        Renovate\n        Tekton-app\n        Tekton-operator\n    end\n    subgraph Layer8\n        Dashy\n        Kavita\n        Quake\n        Grocy\n    end\n    subgraph Layer9\n        BuildAll\n        Portfolio\n        Template\n        TektonInterceptor\n    end\n    Layer1 --\x3e Layer2\n    Layer2 --\x3e Layer3\n    Layer3 --\x3e Layer4\n    Layer4 --\x3e Layer5\n    Layer7 --\x3e Layer6\n    Layer4 --\x3e Layer7\n    Layer4 --\x3e Layer8\n    Layer7 --\x3e Layer9\n    BuildAll --\x3e Wireguard"}),(0,i.kt)("h3",{id:"cni"},"CNI"),(0,i.kt)("p",null,"What is a CNI ? Well it's a Container Network Interface and it's used to create network for container. I'm using ",(0,i.kt)("a",{parentName:"p",href:"https://cilium.io/"},"Cilium")," as my CNI. It's a really good CNI and it's working really well. I'm using it in BGP mode, so i can have a really good network and i can use it to connect my cluster to my home network if needed. The setup is actually really easy but not complete at the moment. What i'm missing:"),(0,i.kt)("ul",{className:"contains-task-list"},(0,i.kt)("li",{parentName:"ul",className:"task-list-item"},(0,i.kt)("input",{parentName:"li",type:"checkbox",checked:!1,disabled:!0})," ","Setup the Service Mesh"),(0,i.kt)("li",{parentName:"ul",className:"task-list-item"},(0,i.kt)("input",{parentName:"li",type:"checkbox",checked:!1,disabled:!0})," ","Setup the Monitoring"),(0,i.kt)("li",{parentName:"ul",className:"task-list-item"},(0,i.kt)("input",{parentName:"li",type:"checkbox",checked:!1,disabled:!0})," ","Setup the ",(0,i.kt)("a",{parentName:"li",href:"https://docs.cilium.io/en/stable/network/servicemesh/gateway-api/gateway-api/#what-is-gateway-api"},"Gateway Api")," - ",(0,i.kt)("a",{parentName:"li",href:"https://gateway-api.sigs.k8s.io/"},"Doc"))),(0,i.kt)("h3",{id:"csi"},"CSI"),(0,i.kt)("p",null,"What is a CSI ? Well it's a Container Storage Interface and it's used to create storage for container. I'm using ",(0,i.kt)("a",{parentName:"p",href:"https://longhorn.io/"},"Longhorn")," as my CSI. It's a really good CSI and it's working really well. I'm also using it to backup my data."),(0,i.kt)("h3",{id:"gateway-api"},"Gateway Api"),(0,i.kt)("p",null,"During my search for more observability and security, i found the ",(0,i.kt)("a",{parentName:"p",href:"https://gateway-api.sigs.k8s.io/"},"Gateway Api")," relatable has a Ingress Killer. Why does the Ingress should be replaced by the GateWay Api? The Gateway Api is more compatible with the CNI and Service Mesh. It's also more secure and flexible by being more configurable. If you want to know more click on the link above."),(0,i.kt)("h2",{id:"upgrade"},"Upgrade"),(0,i.kt)("p",null,"In order to facilitate my upgrade process, i setup ",(0,i.kt)("a",{parentName:"p",href:"https://www.mend.io/renovate/"},"Renovate")," to handle the upgrade of my dependencies. It's really easy to use and it's working really well. I just need to execute the renovate job daily and it create PR when needed and merge it when i think it's ok."),(0,i.kt)("p",null,"Well we need everything to be up to date, so i upgraded everything to the latest version available like"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"No Upgrade this time")),(0,i.kt)("p",null,"While working on the upgrade part, i ended up thinking that setting up Changelog would be a good thing. So i'm thinking of including ",(0,i.kt)("a",{parentName:"p",href:"https://docs.cocogitto.io/"},"cog"),"."),(0,i.kt)("h2",{id:"next-to-do"},"Next to do"),(0,i.kt)("ul",{className:"contains-task-list"},(0,i.kt)("li",{parentName:"ul",className:"task-list-item"},(0,i.kt)("input",{parentName:"li",type:"checkbox",checked:!1,disabled:!0})," ","Setup the Service Mesh ",(0,i.kt)("a",{parentName:"li",href:"https://github.com/batleforc/WeeboGitOps/issues/71"},"#71")),(0,i.kt)("li",{parentName:"ul",className:"task-list-item"},(0,i.kt)("input",{parentName:"li",type:"checkbox",checked:!1,disabled:!0})," ","Setup the Monitoring/Overservability of Cilium ",(0,i.kt)("a",{parentName:"li",href:"https://github.com/batleforc/WeeboGitOps/issues/71"},"#71")),(0,i.kt)("li",{parentName:"ul",className:"task-list-item"},(0,i.kt)("input",{parentName:"li",type:"checkbox",checked:!1,disabled:!0})," ","Migrate to the Gateway Api ",(0,i.kt)("a",{parentName:"li",href:"https://github.com/batleforc/WeeboGitOps/issues/70"},"#70")),(0,i.kt)("li",{parentName:"ul",className:"task-list-item"},(0,i.kt)("input",{parentName:"li",type:"checkbox",checked:!1,disabled:!0})," ","Slowly secure the Harbor Cache ",(0,i.kt)("a",{parentName:"li",href:"https://github.com/batleforc/WeeboGitOps/issues/55"},"#55")),(0,i.kt)("li",{parentName:"ul",className:"task-list-item"},(0,i.kt)("input",{parentName:"li",type:"checkbox",checked:!1,disabled:!0})," ","Include KEDA and the PodAutoScaller ",(0,i.kt)("a",{parentName:"li",href:"https://github.com/batleforc/WeeboGitOps/issues/17"},"#17")),(0,i.kt)("li",{parentName:"ul",className:"task-list-item"},(0,i.kt)("input",{parentName:"li",type:"checkbox",checked:!1,disabled:!0})," ","Pr\xe9parer l'ajout de nouveaux uttilisateurs ",(0,i.kt)("a",{parentName:"li",href:"https://github.com/batleforc/WeeboGitOps/issues/72"},"#72")),(0,i.kt)("li",{parentName:"ul",className:"task-list-item"},(0,i.kt)("input",{parentName:"li",type:"checkbox",checked:!1,disabled:!0})," ","Travailler sur un un \xe9quivalent a Tibco BW en passant possiblement par ",(0,i.kt)("a",{parentName:"li",href:"https://knative.dev/"},"Knative")," ",(0,i.kt)("a",{parentName:"li",href:"https://github.com/batleforc/WeeboGitOps/issues/69"},"#69"))),(0,i.kt)("p",null,"While i was upgrading everything it become obvious that i need to upgrade my use of Github. Then i moved from the old Github Dashboard to ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/users/batleforc/projects/7/views/1"},"the new one"),". Event if i wasn't writing the doc, i was still working on the project and updating the dashboard and issues."))}h.isMDXComponent=!0}}]);