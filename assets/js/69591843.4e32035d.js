"use strict";(self.webpackChunkgit_ops_doc=self.webpackChunkgit_ops_doc||[]).push([[677],{3905:(e,t,a)=>{a.d(t,{Zo:()=>p,kt:()=>d});var o=a(7294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function n(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,o)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?n(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):n(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,o,r=function(e,t){if(null==e)return{};var a,o,r={},n=Object.keys(e);for(o=0;o<n.length;o++)a=n[o],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(o=0;o<n.length;o++)a=n[o],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var u=o.createContext({}),s=function(e){var t=o.useContext(u),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},p=function(e){var t=s(e.components);return o.createElement(u.Provider,{value:t},e.children)},c="mdxType",h={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},m=o.forwardRef((function(e,t){var a=e.components,r=e.mdxType,n=e.originalType,u=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),c=s(a),m=r,d=c["".concat(u,".").concat(m)]||c[m]||h[m]||n;return a?o.createElement(d,i(i({ref:t},p),{},{components:a})):o.createElement(d,i({ref:t},p))}));function d(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var n=a.length,i=new Array(n);i[0]=m;var l={};for(var u in t)hasOwnProperty.call(t,u)&&(l[u]=t[u]);l.originalType=e,l[c]="string"==typeof e?e:r,i[1]=l;for(var s=2;s<n;s++)i[s]=a[s];return o.createElement.apply(null,i)}return o.createElement.apply(null,a)}m.displayName="MDXCreateElement"},8470:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>u,contentTitle:()=>i,default:()=>h,frontMatter:()=>n,metadata:()=>l,toc:()=>s});var o=a(7462),r=(a(7294),a(3905));const n={slug:"one-year-later",title:"One year later",authors:"batleforc",tags:["docusaurus","flux","gitops","daily"]},i=void 0,l={permalink:"/WeeboGitOps/blog/one-year-later",editUrl:"https://github.com/batleforc/WeeboGitOps/tree/Doc/Main/blog/2023-07-29-v3.md",source:"@site/blog/2023-07-29-v3.md",title:"One year later",description:"Well it's been a little more than a year since the last post. I've been busy with a lot of things and I didn't have the time to write anything. But I'm back and I will try to write more often. If you are reading this, thank you for your interest in my blog about the GitOps project. I hope you will find it useful.",date:"2023-07-29T00:00:00.000Z",formattedDate:"29 juillet 2023",tags:[{label:"docusaurus",permalink:"/WeeboGitOps/blog/tags/docusaurus"},{label:"flux",permalink:"/WeeboGitOps/blog/tags/flux"},{label:"gitops",permalink:"/WeeboGitOps/blog/tags/gitops"},{label:"daily",permalink:"/WeeboGitOps/blog/tags/daily"}],readingTime:2.255,hasTruncateMarker:!1,authors:[{name:"Maxime",title:"Developer of this project",url:"https://github.com/batleforc",imageURL:"https://github.com/batleforc.png",key:"batleforc"}],frontMatter:{slug:"one-year-later",title:"One year later",authors:"batleforc",tags:["docusaurus","flux","gitops","daily"]},nextItem:{title:"Init Doc",permalink:"/WeeboGitOps/blog/init-doc"}},u={authorsImageUrls:[void 0]},s=[{value:"What&#39;s new",id:"whats-new",level:2},{value:"Auth me now",id:"auth-me-now",level:3},{value:"Automate me",id:"automate-me",level:3},{value:"Upgrade",id:"upgrade",level:3},{value:"Next to do",id:"next-to-do",level:3}],p={toc:s},c="wrapper";function h(e){let{components:t,...a}=e;return(0,r.kt)(c,(0,o.Z)({},p,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"Well it's been a little more than a year since the last post. I've been busy with a lot of things and I didn't have the time to write anything. But I'm back and I will try to write more often. If you are reading this, thank you for your interest in my blog about the GitOps project. I hope you will find it useful."),(0,r.kt)("h2",{id:"whats-new"},"What's new"),(0,r.kt)("p",null,"hmmm... Everything ? In the past few day, i just graduated from my Master degree, and just got my first job out of studie.\nThis project never stopped, but i didn't have enough time to write about it."),(0,r.kt)("p",null,"The goal is stil the same, having a fully automated kubernetes cluster, with a GitOps approach. Will following some Good practice."),(0,r.kt)("h3",{id:"auth-me-now"},"Auth me now"),(0,r.kt)("p",null,"One of the most nerf wrecking change was to kick out the old auth system ",(0,r.kt)("a",{parentName:"p",href:"https://www.keycloak.org/"},"Keycloak")," and replace it with ",(0,r.kt)("a",{parentName:"p",href:"https://zitadel.com/"},"Zitadel"),"."),(0,r.kt)("p",null,"Why the change ? Zitadel bring the hability to ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/users/batleforc/projects/7/views/1?pane=issue&itemId=34063201"},"fully automate"),' (except SAML) the auth process and to create each application with a terraform "CronJob".'),(0,r.kt)("p",null,"The pros of automating the auth process is that you dont need to create each thing by hand, and you can easily create a new application with a simple terraform file. And you are sure that whats automated will be the source of truth thought time."),(0,r.kt)("p",null,"At the moment i didn't find any cons, except for the huge amout of ram that ",(0,r.kt)("a",{parentName:"p",href:"https://www.cockroachlabs.com/"},"CochroachDB")," need to run when considering Keycloak use Postgresql. (The saml part is not a cons, it's just not implemented yet)."),(0,r.kt)("h3",{id:"automate-me"},"Automate me"),(0,r.kt)("p",null,"With the new auth system, i was able to automate the oidc setup for each application. But by discovering Zitadel, i also discoverd ",(0,r.kt)("a",{parentName:"p",href:"https://www.terraform.io/"},"Terraform"),"."),(0,r.kt)("p",null,"It allow me to:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Automate the oidc setup for each application (Grafana, Gitea, Harbor, WIP: Sonarqube, Oauth2Proxy, ...)"),(0,r.kt)("li",{parentName:"ul"},"Automate Harbor (Project, Robot account, Configuration, ...)"),(0,r.kt)("li",{parentName:"ul"},"Automate some simple step (creation of Kubeconfig)"),(0,r.kt)("li",{parentName:"ul"},"Automate Sonarqube (WIP)"),(0,r.kt)("li",{parentName:"ul"},"Automate Minio (WIP)")),(0,r.kt)("h3",{id:"upgrade"},"Upgrade"),(0,r.kt)("p",null,"Well we need everything to be up to date, so i upgraded everything to the latest version available like"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Gitea (need to be done manually, because each upgrade break everything) (1.18 -> 1.20)"),(0,r.kt)("li",{parentName:"ul"},"Tekton (Just an upgrade of the CRD)"),(0,r.kt)("li",{parentName:"ul"},"Harbor (automated)"),(0,r.kt)("li",{parentName:"ul"},"Haproxy (0.14.2 -> 0.14.4)"),(0,r.kt)("li",{parentName:"ul"},"CertManager"),(0,r.kt)("li",{parentName:"ul"},"Tempo (replace Jaeger because it's easier to use)"),(0,r.kt)("li",{parentName:"ul"},"Flux (0.41.2 -> 2.0.1)")),(0,r.kt)("h3",{id:"next-to-do"},"Next to do"),(0,r.kt)("p",null,"While i was upgrading everything it become obvious that i need to upgrade my use of Github. Then i moved from the old Github Dashboard to ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/users/batleforc/projects/7/views/1"},"the new one"),". Event if i wasn't writing the doc, i was still working on the project and updating the dashboard and issues."))}h.isMDXComponent=!0}}]);